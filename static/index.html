<!DOCTYPE html>

<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <title>Cybiko game archive</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>
        // Call out to get the game list
        function getGames(pageNum) {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    games = JSON.parse(this.responseText);
                    // Loop through games and insert them into table
                    var container = document.getElementById("bigrow");
                    for (var i = 0; i < games.length; i++) {

                        // var row = table.insertRow(i + 1);
                        // var icon = row.insertCell(0);
                        // icon.innerHTML = '<img src="/public/resources/' + games[i].folder_name + "/root-ico.png" + '" width="48" height="47">';
                        // var name = row.insertCell(1);
                        // name.innerHTML = games[i].name;
                        // var moreinfo = row.insertCell(2);
                        // moreinfo.innerHTML = '<a href="' + "/games/" + games[i].folder_name + "/" + '">More info</a>';
                        var col = document.createElement("div");
                        col.className = "col-md-4";
                        var card = document.createElement("div");
                        card.className = "card";
                        var cardBody = document.createElement("div");
                        cardBody.className = "card-body";
                        var cardImg = document.createElement("img");
                        cardImg.className = "card-img-top";
                        cardImg.src = "/public/resources/" + games[i].folder_name + "/intro-pic.png";
                        cardImg.alt = games[i].name + " intro image";
                        var cardText = document.createElement("p");
                        cardText.className = "card-text";
                        cardText.innerHTML = games[i].text;
                        var cardLinkContainer = document.createElement("div");
                        cardLinkContainer.className = "d-flex justify-content-between align-items-center";
                        var cardLinkbtnGroup = document.createElement("div");
                        cardLinkbtnGroup.className = "btn-group";
                        var cardLinkViewMoreButton = document.createElement("button");
                        cardLinkViewMoreButton.className = "btn btn-sm btn-outline-primary";
                        cardLinkViewMoreButton.type = "button";
                        cardLinkViewMoreButton.innerHTML = "View more";
                        cardLinkTweetThisButton = document.createElement("button");
                        cardLinkTweetThisButton.className = "btn btn-sm btn-outline-secondary";
                        cardLinkTweetThisButton.type = "button";
                        cardLinkTweetThisButton.innerHTML = "Tweet this";
                        cardLinkbtnGroup.appendChild(cardLinkViewMoreButton);
                        cardLinkbtnGroup.appendChild(cardLinkTweetThisButton);
                        cardLinkContainer.appendChild(cardLinkbtnGroup);

                        cardBody.appendChild(cardText);
                        cardBody.appendChild(cardLinkContainer);
                        card.appendChild(cardImg);
                        card.appendChild(cardBody);
                        col.appendChild(card);
                        container.appendChild(col);
                    }
                } else {
                    // Cybiko loading animation?
                }
            };
            xhttp.open("GET", "/games/"+pageNum, true);
            xhttp.send();
        }
        document.addEventListener("DOMContentLoaded", function (event) {
            getGames(1);
        });
        function loadMore() {
            var pageNum = document.getElementById("pagenum").innerHTML;
            getGames(parseInt(pageNum) + 1);
            document.getElementById("pagenum").innerHTML = parseInt(pageNum) + 1;

        }
    </script>
</head>

<body>
    <div id="mainContainer" class="container">
        <div id="pagenum">
            1
        </div>
        <div id="bigrow" class="row" data-masonry='{"percentPosition": true }'>
        </div>
        <button onclick=loadMore()>load more</button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
</body>

</html>
